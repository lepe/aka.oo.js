/**
 * widgets.ui.js 1.0.0 
 * Author: A. Lepe (www.alepe.com)
 * Released under GPL 3.0 http://www.gnu.org/licenses/gpl-3.0.en.html
 */

var Class=chic.Class;var UI=Class.extend({elem:null,baseurl:"",widgets:[],init:function(){},_query:function(a,b){a.params.req=a.request||a.template;$.getJSON(this.baseurl,a.params).done(function(c){b(a,c)})},_getTemplate:function(a,b){$.get("/htm/"+a.template+".htm").done(function(c){a.html=c;b(a)})},_transform:function(c,e,d){var a=$(c.html);var b=$("[id^='"+c.prefix+"']").length;c.widget_id=c.prefix+(b);a.attr("id",c.widget_id);if(a.children().length===0){$(c.parent)[c.action](a);if(e!==null){$(c.parent).render(e.models,e.directives)}}else{if(e!==null){a.render(e.models,e.directives)}$(c.parent)[c.action](a)}if(d!==undefined){d(a)}},addWidget:function(c,b,a){b.parent=a;b.action=c;this.widgets.push(b);return a},doWidgets:function(d){var c=this;for(var a in this.widgets){var b=c.widgets[a];if(d===undefined||d.is(b.parent)||d.find(b.parent).length){c._getTemplate(b,function(e){e.setup();e.update=function(){c._query(e,function(g,f){g.render(f,function(i,h){c._transform(g,i,h)})})};e.update()})}}}});
var Widget=Class.extend({initargs:"",template:"",category:"",params:{},prefix:"widget_",parent:null,action:null,html:null,widget_id:"",init:function(){this.initargs=arguments},setup:function(){},render:function(a,b){b({models:{},directives:{}})},update:function(){}});